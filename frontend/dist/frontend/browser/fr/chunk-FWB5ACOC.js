import{a as z}from"./chunk-72PZFQ64.js";import{a as M}from"./chunk-O46OOCLH.js";import{c as V}from"./chunk-7DSHKHWS.js";import{a as re,c as se,e as ae,m as ce,o as X}from"./chunk-L3J3RS7V.js";import{a as oe}from"./chunk-7BMKDUXL.js";import{$ as T,Da as ie,H as E,I as P,J as w,K as R,L as O,M as r,N as s,O as u,P as v,Q as A,S as g,T as F,U as y,V as C,W as p,X as $,Y as l,Z as x,a as j,aa as L,ba as D,ca as K,da as J,ea as Q,fa as Z,k as W,ka as k,la as G,n as S,o as m,p as _,s as f,sa as ee,w as d,ya as te,z as b,za as ne}from"./chunk-KEBKWCID.js";var H=class o{url=`${oe.url_api}/posts`;http=S(ee);constructor(){}create(t,e){return this.http.post(`${this.url}/${e}/comments`,t);}update(t,e,n){return this.http.put(`${this.url}/${e}/comments/${n}`,t);}delete(t,e){return this.http.delete(`${this.url}/${t}/comments/${e}`);}static ɵfac=function(e){return new(e||o)();};static ɵprov=W({token:o,factory:o.ɵfac,providedIn:"root"});};function de(o,t){if(o&1){let e=g();v(0,"div",4),$("click",function(){m(e);let i=l();return _(i.cancel());}),v(1,"div",5),$("click",function(i){return m(e),_(i.stopPropagation());}),v(2,"h2"),C(3,0),A(),v(4,"p"),T(5),A(),v(6,"div",6)(7,"button",7),$("click",function(){m(e);let i=l();return _(i.accept());}),C(8,1),A(),v(9,"button",8),$("click",function(){m(e);let i=l();return _(i.cancel());}),C(10,2),A()()()();}if(o&2){let e=l();d(5),L(e.text());}}var N=class o{visible=f(!1);accepted=k();text=G();open(){this.visible.set(!0);}accept(){this.visible.set(!1),this.accepted.emit();}cancel(){this.visible.set(!1);}static ɵfac=function(e){return new(e||o)();};static ɵcmp=b({type:o,selectors:[["app-confirm-dialog"]],inputs:{text:[1,"text"]},outputs:{accepted:"accepted"},decls:1,vars:1,consts:()=>{let t;t="Confirmation";let e;e="Accepter";let n;return n="Annuler",[t,e,n,[1,"overlay"],[1,"overlay",3,"click"],[1,"modal","animate-in",3,"click"],[1,"actions"],[1,"btn","accept",3,"click"],[1,"btn","cancel",3,"click"]];},template:function(e,n){e&1&&E(0,de,11,1,"div",3),e&2&&P(n.visible()?0:-1);},styles:[".overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;display:flex;justify-content:center;align-items:center;z-index:50;animation:_ngcontent-%COMP%_fadeIn .3s ease forwards}.modal[_ngcontent-%COMP%]{background:#141826f2;padding:2rem;border-radius:16px;width:320px;max-width:90%;text-align:center;box-shadow:0 10px 25px #00000040;transform:scale(.8);opacity:0;animation:_ngcontent-%COMP%_slideIn .3s ease forwards;color:#fff}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:scale(.8) translateY(-20px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_slideOut{0%{transform:scale(1) translateY(0);opacity:1}to{transform:scale(.8) translateY(-20px);opacity:0}}.actions[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:space-around;gap:1rem}.btn[_ngcontent-%COMP%]{flex:1;padding:.6rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:transform .2s ease,background-color .2s ease}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.btn.accept[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.btn.accept[_ngcontent-%COMP%]:hover{background-color:#43a047}.btn.cancel[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.btn.cancel[_ngcontent-%COMP%]:hover{background-color:#e53935}"]});};function pe(o,t){if(o&1){let e=g();r(0,"div",4),p("click",function(){m(e);let i=l();return _(i.cancel());}),r(1,"div",5),p("click",function(i){return m(e),_(i.stopPropagation());}),r(2,"h2"),T(3),s(),r(4,"p"),C(5,0),s(),r(6,"input",6),Q("ngModelChange",function(i){m(e);let a=l();return J(a.userInput,i)||(a.userInput=i),_(i);}),p("keydown.enter",function(){m(e);let i=l();return _(i.submit());}),s(),r(7,"div",7)(8,"button",8),p("click",function(){m(e);let i=l();return _(i.submit());}),C(9,1),s(),r(10,"button",9),p("click",function(){m(e);let i=l();return _(i.cancel());}),C(11,2),s()()()();}if(o&2){let e=l();d(3),D("",e.getText()," "),d(3),K("ngModel",e.userInput);}}var B=class o{visible=f(!1);userInput=f("");edit=f(!1);submitted=k();getText=()=>this.edit()?"Modifier le commentaire":"Entrez un commentaire";open(t=""){this.edit.set(t!=""),this.userInput.set(t),this.visible.set(!0);}submit(){this.userInput().trim()&&(this.submitted.emit(this.userInput()),this.visible.set(!1));}cancel(){this.visible.set(!1);}static ɵfac=function(e){return new(e||o)();};static ɵcmp=b({type:o,selectors:[["app-input-text-dialog"]],outputs:{submitted:"submitted"},decls:1,vars:1,consts:()=>{let t;t="\xC9crivez ici...";let e;e="Veuillez \xE9crire ce que vous souhaitez :";let n;n="Accepter";let i;return i="Annuler",[e,n,i,[1,"overlay"],[1,"overlay",3,"click"],[1,"modal","animate-in",3,"click"],["type","text","placeholder",t,3,"ngModelChange","keydown.enter","ngModel"],[1,"actions"],[1,"btn","accept",3,"click"],[1,"btn","cancel",3,"click"]];},template:function(e,n){e&1&&E(0,pe,12,2,"div",3),e&2&&P(n.visible()?0:-1);},dependencies:[ce,re,se,ae],styles:[".overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0f121cd9;display:flex;justify-content:center;align-items:center;z-index:2000;animation:_ngcontent-%COMP%_fadeIn .3s ease forwards}.modal[_ngcontent-%COMP%]{background:#141826f2;padding:2rem;border-radius:16px;width:350px;max-width:90%;text-align:center;box-shadow:0 10px 25px #00000080;transform:scale(.8);opacity:0;animation:_ngcontent-%COMP%_slideIn .3s ease forwards;color:#fff;font-family:Poppins,sans-serif}input[_ngcontent-%COMP%]{width:100%;padding:10px;margin-top:1rem;border-radius:8px;border:none;outline:none;font-size:14px;font-family:inherit;color:#fff;background:#ffffff14;transition:border .3s,background .3s}input[_ngcontent-%COMP%]:focus{background:#ffffff26;border:1px solid #4facfe}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:scale(.8) translateY(-20px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}.actions[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:space-around;gap:1rem}.btn[_ngcontent-%COMP%]{flex:1;padding:.6rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:transform .2s ease,background-color .3s ease;font-family:inherit}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.btn.accept[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.btn.cancel[_ngcontent-%COMP%]{background:#f44336e6;color:#fff}"]});};var ue=(o,t)=>t.id;function fe(o,t){if(o&1){let e=g();r(0,"span",18)(1,"button",19),p("click",function(){m(e);let i=l().$implicit,a=l(),c=x(17);return _(a.editComment(i.id,i.content,c));}),u(2,"i",20),s(),r(3,"button",19),p("click",function(){m(e);let i=l().$implicit,a=l(),c=x(19);return _(a.deleteComment(i.id,c));}),u(4,"i",21),s()();}}function ge(o,t){if(o&1&&(r(0,"div",8)(1,"span",17),u(2,"i",9),T(3),s(),E(4,fe,5,0,"span",18),s()),o&2){let e=t.$implicit,n=l();d(3),D(" ",e.content," "),d(),P(n.user.username==e.authorUsername?4:-1);}}var Y=class o{postService=S(z);commentService=S(H);authService=S(V);loading=f(!1);id=G(0);post=f(null);user=this.authService.getUser();idComment=0;edit=!1;textDeleteConfirm="\xCAtes-vous s\xFBr de vouloir supprimer ce commentaire ?";toggleComments(t,e,n=!1){let i="Chargement...";e.textContent=i;let a=this.id();this.postService.getById(a).subscribe({next:c=>{let I=t.classList.contains("open")?"Voir plus":"Fermer";if(n)t.classList.add("open");else if(c.data.comments.length>0)t.classList.toggle("open");else{let h="Pas de commentaires ! - Cliquez pour recharger";e.textContent=h;return;}e.textContent=I,this.post.set(c);}});}onComment(t,e,n){if(this.edit){this.onEditComment(t,e,n);return;}this.loading.set(!0);let i=this.id();this.commentService.create({content:t},i).subscribe({next:a=>{this.loading.set(!1),this.toggleComments(e,n,!0);let c="Commentaire ajout\xE9 !";M.success(c,"");},error:a=>{this.loading.set(!1);let c="Erreur lors de la cr\xE9ation du commentaire !";M.error(c,"");}});}deleteComment(t,e){this.idComment=t,e.open();}onAcceptDelete(){this.loading.set(!0);let t=this.id();this.commentService.delete(t,this.idComment).subscribe({next:e=>{this.post.update(i=>{let a=j({},i);return a.data.comments=a.data.comments.filter(c=>c.id!=this.idComment),a;}),this.loading.set(!1),this.idComment=0;let n="Commentaire supprim\xE9 avec succ\xE8s !";M.success(n,"");},error:e=>{this.loading.set(!1);let n="Erreur lors de la suppression !";M.error(n,"");}});}editComment(t,e,n){this.idComment=t,this.edit=!0,n.open(e);}onEditComment(t,e,n){this.loading.set(!0);let i=this.id();this.commentService.update({content:t},i,this.idComment).subscribe({next:a=>{this.post.update(I=>{let h=j({},I),me=h.data.comments.findIndex(_e=>_e.id==this.idComment);return h.data.comments[me].content=t,h;}),this.idComment=0,this.edit=!1,this.loading.set(!1);let c="\xC9chec du chargement du post !";M.success(c,"");},error:a=>{this.loading.set(!1);let c="\xC9chec du chargement du post !";M.error(c,"");}});}static ɵfac=function(e){return new(e||o)();};static ɵcmp=b({type:o,selectors:[["app-comments"]],inputs:{id:[1,"id"]},decls:20,vars:2,consts:()=>{let t;t=""+"\uFFFD#5\uFFFD"+""+"\uFFFD/#5\uFFFD"+" Commentaires... ";let e;e=""+"\uFFFD#8\uFFFD"+""+"\uFFFD/#8\uFFFD"+" commenter ";let n;return n="Voir plus",[["container",""],["btnVermas",""],["dialog",""],["dialogDelete",""],t,e,n,[1,"comments"],[1,"comment"],[1,"fas","fa-comment"],[1,"add-comment",3,"click"],[1,"fas","fa-plus"],[1,"more-comments"],[1,"toggle-comments",3,"click"],[3,"show"],[3,"submitted"],[3,"accepted","text"],[1,"overflow-wrap"],[1,"btns-actions"],[3,"click"],[1,"fas","fa-edit"],[1,"fas","fa-trash-alt"]];},template:function(e,n){if(e&1){let i=g();r(0,"div",7,0)(2,"div",8)(3,"span"),F(4,4),u(5,"i",9),y(),s(),r(6,"span",10),p("click",function(){m(i);let c=x(17);return _(c.open());}),F(7,5),u(8,"i",11),y(),s()(),r(9,"div",12),w(10,ge,5,2,"div",8,ue),s(),r(12,"button",13,1),p("click",function(){m(i);let c=x(1),I=x(13);return _(n.toggleComments(c,I));}),C(14,6),s()(),u(15,"app-loading",14),r(16,"app-input-text-dialog",15,2),p("submitted",function(c){m(i);let I=x(1),h=x(13);return _(n.onComment(c,I,h));}),s(),r(18,"app-confirm-dialog",16,3),p("accepted",function(){return m(i),_(n.onAcceptDelete());}),s();}if(e&2){let i;d(10),R((i=n.post())==null||i.data==null?null:i.data.comments),d(5),O("show",n.loading()),d(3),O("text",n.textDeleteConfirm);}},dependencies:[X,B,N],styles:[".comments[_ngcontent-%COMP%]{margin-top:10px}.comment[_ngcontent-%COMP%]{background:#ffffff14;padding:10px 15px;border-radius:10px;margin-bottom:10px;font-size:14px;display:flex;align-items:center;gap:8px}.add-comment[_ngcontent-%COMP%]{margin-left:auto;font-size:13px;background:#848484;padding:1px 10px;border-radius:6px;cursor:pointer}.more-comments[_ngcontent-%COMP%]{display:none}.comments.open[_ngcontent-%COMP%]   .more-comments[_ngcontent-%COMP%]{display:block;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}.toggle-comments[_ngcontent-%COMP%]{background:none;border:none;color:#4facfe;cursor:pointer;font-size:14px;margin-top:5px;transition:color .3s}.toggle-comments[_ngcontent-%COMP%]:hover{color:#82c0ff}.btns-actions[_ngcontent-%COMP%]{margin-left:auto}.btns-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:13px;background:#848484;padding:3px 10px;border-radius:6px;cursor:pointer;outline:none;border:none;color:#fff;margin:3px 2px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}"]});};var Ce=(o,t)=>t.id;function xe(o,t){if(o&1){let e=g();r(0,"button",13),u(1,"i",14),s(),r(2,"button",15),p("click",function(){m(e);let i=l().$implicit,a=l(),c=x(6);return _(a.deletePost(i.id,c));}),u(3,"i",16),s();}if(o&2){let e=l().$implicit;O("routerLink",Z("/update/",e.id));}}function Te(o,t){if(o&1&&(r(0,"div",3)(1,"div",7)(2,"h2"),u(3,"i",8),T(4),s(),r(5,"div",9),E(6,xe,4,2),s()(),r(7,"div",10),T(8),s(),r(9,"div",11),T(10),s(),u(11,"app-comments",12),s()),o&2){let e=t.$implicit,n=l();d(4),D(" ",e.authorUsername),d(2),P(n.user.username==e.authorUsername?6:-1),d(2),L(e.title),d(2),L(e.content),d(),O("id",e.id);}}function Me(o,t){o&1&&(r(0,"div",4),F(1,1),u(2,"br"),y(),s());}var le=class o{postService=S(z);authService=S(V);user=this.authService.getUser();posts=f([]);loading=f(!0);idPost=0;textDeleteConfirm="\xCAtes-vous s\xFBr de vouloir supprimer ce post ?";constructor(){this.loadPosts();}loadPosts(){this.loading.set(!0),this.postService.getAll().subscribe({next:t=>{this.posts.set(t.data),this.loading.set(!1);}});}deletePost(t,e){this.idPost=t,e.open();}onAcceptDelete(){this.loading.set(!0),this.postService.delete(this.idPost).subscribe({next:t=>{this.loading.set(!1);let e="Post supprim\xE9 avec succ\xE8s !";M.success(e,""),this.posts.update(n=>n.filter(i=>i.id!=this.idPost));},error:t=>{this.loading.set(!1),M.success(t?.message,"");}});}static ɵfac=function(e){return new(e||o)();};static ɵcmp=b({type:o,selectors:[["app-posts"]],decls:7,vars:3,consts:()=>{let t;return t="Aucun post cr\xE9\xE9. "+"\uFFFD#2\uFFFD\uFFFD/#2\uFFFD"+"Cr\xE9ez-en un !",[["dialogDelete",""],t,[1,"container"],[1,"post"],[1,"noItems"],[3,"show"],[3,"accepted","text"],[1,"post-header"],[1,"fas","fa-user-circle"],[1,"post-actions"],[1,"post-title"],[1,"post-content"],[3,"id"],["routerLinkActive","router-link-active",3,"routerLink"],[1,"fas","fa-edit"],[3,"click"],[1,"fas","fa-trash-alt"]];},template:function(e,n){if(e&1){let i=g();r(0,"div",2),w(1,Te,12,5,"div",3,Ce),E(3,Me,3,0,"div",4),s(),u(4,"app-loading",5),r(5,"app-confirm-dialog",6,0),p("accepted",function(){return m(i),_(n.onAcceptDelete());}),s();}e&2&&(d(),R(n.posts()),d(2),P(!n.loading()&&n.posts().length<=0?3:-1),d(),O("show",n.loading()),d(),O("text",n.textDeleteConfirm));},dependencies:[ie,te,ne,Y,X,N],styles:[".container[_ngcontent-%COMP%]{padding:100px 20px 40px;max-width:750px;margin:0 auto;display:flex;flex-direction:column;gap:25px}.post[_ngcontent-%COMP%]{background:#ffffff0d;border-radius:15px;padding:20px;box-shadow:0 4px 10px #0000004d;transition:transform .3s;position:relative;z-index:2}.post[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.post-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.post-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0;display:flex;align-items:center;gap:8px}.post-title[_ngcontent-%COMP%]{margin-top:10px;font-weight:700;text-transform:uppercase}.post-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;margin-left:10px;font-size:16px;transition:color .3s}.post-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#4facfe}.post-content[_ngcontent-%COMP%]{margin:15px 0;font-size:15px;line-height:1.5;overflow-wrap:anywhere}.noItems[_ngcontent-%COMP%]{color:#fff;position:relative;margin:0 auto;text-align:center}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:35px 15px 30px}}"]});};export{le as Posts};/**i18n:b3883ab85ae623dab2f76dee90edb1a23055e95a2aa7383157e4cbec120e5849*/